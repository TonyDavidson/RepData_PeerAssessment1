<h1 id="reproducible-research-peer-assessment-1">Reproducible Research: Peer Assessment 1</h1>
<h2 id="coursera---reproducible-research-stream-005">Coursera - Reproducible Research Stream 005</h2>
<h2 id="student-tony-davidson">Student: Tony Davidson</h2>
<p>Basic settings</p>
<p>Set the working directory</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setwd</span>(<span class="st">&quot;~/GitHub/RepData_PeerAssessment1&quot;</span>)</code></pre>
<p>Load required libraries and set knitr and markdown options.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(dplyr)</code></pre>
<pre><code>## Loading required package: dplyr
## 
## Attaching package: &#39;dplyr&#39;
## 
## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(knitr)
<span class="kw">require</span>(rmarkdown)</code></pre>
<pre><code>## Loading required package: rmarkdown</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">fig.path=</span><span class="st">&quot;figures/&quot;</span>)
opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>) <span class="co"># Always make code visible</span>
opts_chunk$<span class="kw">set</span>(<span class="dt">results =</span> <span class="st">&quot;asis&quot;</span>) <span class="co"># Always show results and graphs</span>
<span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">1</span>) <span class="co"># Turn off scientific notations for numbers</span></code></pre>
<h2 id="loading-and-preprocessing-the-data">Loading and preprocessing the data</h2>
<p>This assignment makes use of data from a personal activity monitoring device. This device collects data at 5 minute intervals through out the day. The data consists of two months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day. Data</p>
<p>The data for this assignment can be downloaded from the course web site:</p>
<pre><code>Dataset: Activity monitoring data [52K]</code></pre>
<p>The variables included in this dataset are:</p>
<pre><code>steps: Number of steps taking in a 5-minute interval (missing values are coded as NA)

date: The date on which the measurement was taken in YYYY-MM-DD format

interval: Identifier for the 5-minute interval in which measurement was taken</code></pre>
<p>The dataset is stored in a comma-separated-value (CSV) file and there are a total of 17,568 observations in this dataset.</p>
<p>Note: The data use in the analysis was downloded from &quot;https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip&quot; on August 8, 2014 at 5:25 pm GMT +8 hrs</p>
<p>Load and clean the data by removing NA values.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unzip</span>(<span class="st">&quot;activity.zip&quot;</span>)
activity &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;activity.csv&quot;</span>, <span class="dt">colClasses =</span> <span class="kw">c</span>(<span class="st">&quot;integer&quot;</span>, <span class="st">&quot;Date&quot;</span>, <span class="st">&quot;factor&quot;</span>))
activity$month &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">format</span>(activity$date, <span class="st">&quot;%m&quot;</span>))
activitynoNA &lt;-<span class="st"> </span><span class="kw">na.omit</span>(activity)
<span class="kw">rownames</span>(activitynoNA) &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(activitynoNA)
<span class="kw">dim</span>(activitynoNA)</code></pre>
<p>[1] 15264 4</p>
<h2 id="what-is-the-mean-total-number-of-steps-taken-per-day">What is the mean total number of steps taken per day?</h2>
<p>Create a dataset with the total number of steps taken per day.</p>
<pre class="sourceCode r"><code class="sourceCode r">steps_per_day &lt;-<span class="st"> </span>activitynoNA %.%<span class="st"> </span><span class="kw">group_by</span>(date) %.%<span class="st"> </span><span class="kw">summarise</span>(<span class="dt">total_steps =</span> <span class="kw">sum</span>(steps))</code></pre>
<p>Make a histogram of the total number of steps taken each day.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(steps_per_day, <span class="kw">hist</span>(total_steps, <span class="dt">main =</span> <span class="st">&quot;Total steps per day (Null Values Excluded)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>))</code></pre>
<div class="figure">
<img src="figures/hist_steps_per_day.png" alt="plot of chunk hist_steps_per_day" /><p class="caption">plot of chunk hist_steps_per_day</p>
</div>
<p>Calculate and report the mean and median total number of steps taken per day.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(steps_per_day, <span class="kw">summary</span>(total_steps))</code></pre>
<p>Min. 1st Qu. Median Mean 3rd Qu. Max. 41 8840 10800 10800 13300 21200</p>
<h2 id="what-is-the-average-daily-activity-pattern">What is the average daily activity pattern?</h2>
<p>Create a dataset with the average number of steps taken per 5-minute interval, averaged across all days (y-axis)</p>
<pre class="sourceCode r"><code class="sourceCode r">average_daily_activity &lt;-<span class="st"> </span>activitynoNA %.%<span class="st"> </span><span class="kw">group_by</span>(interval) %.%<span class="st"> </span><span class="kw">summarise</span>(<span class="dt">average_activity =</span> <span class="kw">mean</span>(steps))</code></pre>
<p>Make a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)</p>
<pre class="sourceCode r"><code class="sourceCode r">activitynoNA$interval &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">as.character</span>(activitynoNA$interval))
interval.mean &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">tapply</span>(activitynoNA$steps, activitynoNA$interval, mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
intervals &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">intervals =</span> <span class="kw">as.numeric</span>(<span class="kw">levels</span>(activitynoNA$interval)), interval.mean)
intervals &lt;-<span class="st"> </span>intervals[<span class="kw">order</span>(intervals$intervals), ]

labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;00:00&quot;</span>, <span class="st">&quot;05:00&quot;</span>, <span class="st">&quot;10:00&quot;</span>, <span class="st">&quot;15:00&quot;</span>, <span class="st">&quot;20:00&quot;</span>)
labels.at &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2000</span>, <span class="dv">500</span>)
<span class="kw">plot</span>(intervals$intervals, intervals$interval.mean, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Average steps per 5-minute interval&quot;</span>, 
    <span class="dt">ylab =</span> <span class="st">&quot;Average steps&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Time of day&quot;</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>)
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> labels.at, <span class="dt">labels =</span> labels)</code></pre>
<div class="figure">
<img src="figures/plot_average_daily_activity.png" alt="plot of chunk plot_average_daily_activity" /><p class="caption">plot of chunk plot_average_daily_activity</p>
</div>
<p>Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?</p>
<pre class="sourceCode r"><code class="sourceCode r">interval_with_max_activity &lt;-<span class="st"> </span>average_daily_activity %.%<span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(average_activity)) %.%<span class="st"> </span><span class="kw">head</span>(<span class="dv">1</span>)
interval_with_max_activity</code></pre>
<p>Source: local data frame [1 x 2]</p>
<p>interval average_activity 1 835 206.2</p>
<p>The 5-minute interval, on average across all the days in the dataset, with the maximum number of steps is <strong>835</strong>.</p>
<h2 id="imputing-missing-values">Imputing missing values</h2>
<p>There are a number of days/intervals where there are missing values (coded as NA). The presence of missing days may introduce bias into some calculations or summaries of the data. This is calculated and reported using the total number of missing values in the dataset (i.e. the total number of rows with NAs)</p>
<pre class="sourceCode r"><code class="sourceCode r">total_number_missing &lt;-<span class="st"> </span><span class="kw">sum</span>(!<span class="kw">complete.cases</span>(activity), <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
total_number_missing</code></pre>
<p>[1] 2304 The total number of missing values in the dataset is 2304. Create a new dataset that is equal to the original dataset but with the missing data filled in with average steps for that 5-minute interval.</p>
<pre class="sourceCode r"><code class="sourceCode r">activity_with_mean_steps_added &lt;-<span class="st"> </span><span class="kw">left_join</span>(activity, average_daily_activity)</code></pre>
<pre><code>## Joining by: &quot;interval&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">activity_corrected &lt;-<span class="st"> </span>activity_with_mean_steps_added[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)]
for (i in <span class="dv">1</span>:<span class="kw">nrow</span>(activity_corrected))
if (<span class="kw">is.na</span>(activity_corrected[i,<span class="dv">1</span>])) activity_corrected[i,<span class="dv">1</span>] &lt;-<span class="st"> </span>activity_with_mean_steps_added[i,<span class="dv">4</span>]</code></pre>
<p>Create a dataset with the average number of steps taken per 5-minute interval, averaged across all days (y-axis), using the original dataset with missing data filled.</p>
<pre class="sourceCode r"><code class="sourceCode r">avgSteps &lt;-<span class="st"> </span><span class="kw">aggregate</span>(activitynoNA$steps, <span class="kw">list</span>(<span class="dt">interval =</span> <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(activitynoNA$interval))), <span class="dt">FUN =</span> <span class="st">&quot;mean&quot;</span>)
<span class="kw">names</span>(avgSteps)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;meanOfSteps&quot;</span>
activity_corrected &lt;-<span class="st"> </span>activity
for (i in <span class="dv">1</span>:<span class="kw">nrow</span>(activity_corrected)) {
if (<span class="kw">is.na</span>(activity_corrected$steps[i])) {
activity_corrected$steps[i] &lt;-<span class="st"> </span>avgSteps[<span class="kw">which</span>(activity_corrected$interval[i] ==<span class="st"> </span>avgSteps$interval), ]$meanOfSteps
}
}

steps_per_day_corrected &lt;-<span class="st"> </span>activity_corrected %.%<span class="st"> </span><span class="kw">group_by</span>(date) %.%<span class="st"> </span><span class="kw">summarise</span>(<span class="dt">total_steps =</span> <span class="kw">sum</span>(steps))</code></pre>
<p>Make a histogram of the total number of steps taken each day, using the original dataset including the imputed missing data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(steps_per_day_corrected, <span class="kw">hist</span>(total_steps, <span class="dt">main =</span> <span class="st">&quot;Total steps per day (Null Values Replaced with Mean)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>))</code></pre>
<div class="figure">
<img src="figures/hist_steps_per_day_corrected.png" alt="plot of chunk hist_steps_per_day_corrected" /><p class="caption">plot of chunk hist_steps_per_day_corrected</p>
</div>
<p>Calculate and report the mean and median total number of steps taken per day, using the original dataset with missing data filled.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(steps_per_day_corrected, <span class="kw">summary</span>(total_steps))</code></pre>
<p>Min. 1st Qu. Median Mean 3rd Qu. Max. 41 9820 10800 10800 12800 21200</p>
<p>As there is <strong>no difference</strong> in the results, it does not matter whether the missing data is excluded or imputed.</p>
<h2 id="are-there-differences-in-activity-patterns-between-weekdays-and-weekends">Are there differences in activity patterns between weekdays and weekends?</h2>
<pre class="sourceCode r"><code class="sourceCode r">activity_corrected$day.type &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;weekend&quot;</span>, <span class="st">&quot;weekday&quot;</span>, <span class="st">&quot;weekday&quot;</span>, 
    <span class="st">&quot;weekday&quot;</span>, <span class="st">&quot;weekday&quot;</span>, <span class="st">&quot;weekday&quot;</span>, <span class="st">&quot;weekend&quot;</span>)[<span class="kw">as.POSIXlt</span>(activity_corrected$date)$wday +<span class="st"> </span>
<span class="st">    </span><span class="dv">1</span>]
activity_corrected$day.type &lt;-<span class="st"> </span><span class="kw">as.factor</span>(activity_corrected$day.type)

weekday &lt;-<span class="st"> </span>activity_corrected[activity_corrected$day.type ==<span class="st"> </span>
<span class="st">    &quot;weekday&quot;</span>, ]
weekend &lt;-<span class="st"> </span>activity_corrected[activity_corrected$day.type ==<span class="st"> </span>
<span class="st">    &quot;weekend&quot;</span>, ]
weekday.means &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">tapply</span>(weekday$steps, weekday$interval, mean))
weekend.means &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">tapply</span>(weekend$steps, weekend$interval, mean))

intervals.day.type &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">intervals =</span> <span class="kw">as.numeric</span>(<span class="kw">levels</span>(activity$interval)), 
    weekday.means, weekend.means)
intervals.day.type &lt;-<span class="st"> </span>intervals.day.type[<span class="kw">order</span>(intervals.day.type$intervals), 
    ]</code></pre>
<p>Plot two time series - weekdays and weekends - of the 5-minute intervals and average number of steps taken.</p>
<pre class="sourceCode r"><code class="sourceCode r">par &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))
<span class="kw">plot</span>(intervals.day.type$intervals, intervals.day.type$weekday.means, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, 
    <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Average steps&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Time of day&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Average steps per 5-minute interval at Weekday&quot;</span>, 
    <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>)
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> labels.at, <span class="dt">labels =</span> labels)
<span class="kw">plot</span>(intervals.day.type$intervals, intervals.day.type$weekend.means, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, 
    <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Average steps&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Time of day&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Average steps per 5-minute interval at Weekend&quot;</span>, 
    <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>)
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> labels.at, <span class="dt">labels =</span> labels)</code></pre>
<div class="figure">
<img src="figures/plot_day_activity_separate.png" alt="plot of chunk plot_day_activity_separate" /><p class="caption">plot of chunk plot_day_activity_separate</p>
</div>
<p>It is a bit difficult to compare the two plots. For a better comparison, combine the time series on a single plot.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(intervals.day.type$intervals, intervals.day.type$weekday.means, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, 
    <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Average steps&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Time of day&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Comparing Average Steps/5 Minutes between Weekday and Weekend&quot;</span>, 
    <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>)
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> labels.at, <span class="dt">labels =</span> labels)
<span class="kw">lines</span>(intervals.day.type$intervals, intervals.day.type$weekend.means, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, 
    <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">legend</span>(<span class="dv">1300</span>, <span class="dv">185</span>, <span class="kw">c</span>(<span class="st">&quot;Weekend&quot;</span>, <span class="st">&quot;Weekday &quot;</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, 
    <span class="st">&quot;red&quot;</span>))</code></pre>
<div class="figure">
<img src="figures/plot_activity_superimposed.png" alt="plot of chunk plot_activity_superimposed" /><p class="caption">plot of chunk plot_activity_superimposed</p>
</div>
